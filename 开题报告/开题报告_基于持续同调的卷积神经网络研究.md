# 基于持续同调的卷积神经网络研究——开题报告

## （1）设计的目的及意义（含国内外研究现状分析）

### 1）中文部分

#### 研究背景与目的
视网膜血管是观察全身微循环状态最直接、最无创的窗口之一，在高血压、糖尿病视网膜病变、动脉硬化等慢性疾病早筛中具有重要临床价值。眼底血管分割作为后续血管口径测量、分支角统计、分形维数计算和病灶风险评估的前置环节，其质量直接决定下游分析的可靠性。与一般目标分割不同，视网膜血管具有“细、长、弱对比、多分叉、结构连续性强”的典型特征：主干血管与毛细末梢尺度差异显著，局部对比度受照明与成像设备影响较大，血管交叉和病变区域还会引入复杂伪影。传统基于像素分类的卷积网络在主体区域通常能够获得较高准确率，但在细小分支、低对比边界和复杂连接处容易出现断裂、粘连或假孔洞，导致拓扑结构失真。

本课题“基于持续同调的卷积神经网络研究”旨在将拓扑数据分析（Topological Data Analysis, TDA）中的持续同调思想引入医学图像分割训练过程，通过构建“像素相似性 + 拓扑一致性”联合优化框架，在不破坏U-Net主体架构可复用性的前提下，提升模型对血管连通性的保持能力。具体目标是：将网络输出概率图映射为二维cubical复形，提取与连通分量相关的持续特征并形成可导近似约束，设计拓扑正则项与Dice/Focal等分割损失协同训练，从而减少血管中心线断裂、抑制虚假孔洞，并提升模型在跨数据集场景下的结构稳定性与泛化能力。

#### 国内外研究现状
医学图像分割的深度学习研究在近十年经历了从“全卷积替代传统手工特征”到“结构先验与学习模型融合”的演进。U-Net提出后，编码器—解码器与跳跃连接结构成为医学分割事实标准，其在小样本条件下表现突出。随后，Attention U-Net、U-Net++、UNet 3+、Residual/Transformer混合结构等方法不断增强多尺度特征表达与全局建模能力，在器官、病灶和血管任务中均有明显提升。对于视网膜血管分割，DUNet、R2U-Net、IterNet 等工作通过级联细化、循环残差、密集监督等方式提高了细血管召回率；同时，GAN式后处理、边界感知损失和不平衡重加权策略也被广泛采用。

然而，上述主流方法大多仍以像素级监督为核心优化目标，默认“像素正确率高”即可带来“结构正确”。在血管这类强拓扑约束目标上，这一假设并不总成立：少量像素误差就可能导致整条末梢断裂，进而使连通分量数、分叉关系和血流路径推断发生显著偏差。正因如此，近五年国际上逐渐兴起拓扑保持分割研究。Hu等提出Topology-Preserving Deep Image Segmentation，通过临界像素约束减少拓扑错误；Clough等给出了面向分割的持续同调拓扑损失框架，将持久配对用于构建可优化目标；Gao等进一步提出面向三维医学图像的cubical PH loss，提高了拓扑监督在体数据上的实用性。与此同时，GPU加速持续同调、可微持久景观（Persistence Landscape）与持久图向量化表示等研究，为“拓扑损失可训练、可扩展、可部署”提供了工程基础。

国内研究方面，围绕眼底血管分割已形成较丰富积累，重点集中在多尺度特征融合、注意力机制、轻量化网络和混合损失函数设计等方向。在DRIVE、STARE、CHASE_DB1等数据集上，多数方法在AUC、F1、Dice等像素指标上持续提升，但对“结构连续性”相关指标（如中心线断裂数、Betti误差、分支完整率）关注仍相对不足。部分工作虽引入形态学后处理来修复断裂，但通常属于推理后规则修补，难以从训练阶段形成结构归纳偏置。因此，将拓扑先验前置到训练目标层面，在国内仍具有明显研究空缺与创新空间。

#### 研究意义
本课题的理论意义在于：探索持续同调与卷积神经网络的可微耦合机制，验证“拓扑先验可作为正则项改善结构化分割”的可行性，为医学图像任务中“像素精度—结构一致性”统一优化提供方法论参考。工程意义在于：在尽量不改动现有U-Net训练管线的条件下，实现可插拔拓扑模块，降低技术迁移成本，使该方法能够方便地扩展到其他细丝状目标（如冠脉、神经纤维、道路骨架）分割任务。应用意义在于：若能有效降低血管断裂与假连接，将直接提高血管直径、分形维数、血管密度等临床量化指标的稳定性，为基层筛查和智能辅助诊断系统提供更可信的图像基础。综合来看，该研究兼具学术前沿性与现实需求导向，对推动“几何先验 + 深度学习”在医学AI中的落地具有积极价值。

### 2）Foreign Language Part (English)

Retinal vessel segmentation is a foundational task in ophthalmic image analysis because the vascular tree reflects systemic microcirculation changes associated with hypertension, diabetes, and cardiovascular risks. In clinical screening pipelines, segmentation quality directly affects downstream measurements, including vessel caliber estimation, tortuosity analysis, branch statistics, and fractal-dimension based biomarkers. Unlike compact organs, retinal vessels are elongated, thin, low-contrast, and highly branched structures. This morphology makes them particularly sensitive to structural errors: a small local false negative may break a vessel branch, while a local false positive may create an artificial connection or hole. Therefore, purely pixel-wise optimization may produce acceptable Dice scores but still fail to preserve anatomical topology.

The primary goal of this project is to investigate a topology-aware convolutional neural network framework based on persistent homology (PH), with U-Net as the segmentation backbone and PyTorch as the implementation framework. Instead of replacing the entire architecture, the project emphasizes a plug-and-play topological regularization strategy: the predicted probability map is interpreted as a 2D cubical complex; topological signatures, especially connected-component persistence in dimension 0, are extracted and converted into differentiable supervisory signals (e.g., via persistence landscape approximations). The final objective is a joint loss of the form
\(L_{total}=L_{seg}+\lambda L_{topo}\),
where the topology term explicitly enforces connectivity consistency while conventional terms (Dice/Focal/BCE variants) optimize pixel overlap and class imbalance. A warm-up and progressive weighting strategy is planned to prevent unstable topology gradients in early training.

Internationally, deep learning based medical segmentation has evolved from fully convolutional models to structurally informed methods. U-Net established the encoder–decoder paradigm with skip connections and remains a strong baseline across tasks. Later variants such as Attention U-Net, U-Net++, and multi-scale refinement networks improved boundary detail and small-structure recall. In retinal vessel analysis, methods like DUNet, R2U-Net, and IterNet further improved thin-vessel segmentation through iterative refinement and residual recurrence. However, most of these models are still supervised by pixel-level losses and do not directly constrain topology. Over the last five years, this limitation has motivated topological learning approaches. Hu et al. introduced topology-preserving segmentation constraints; Clough et al. proposed a persistent-homology based topological loss for image segmentation; and Gao et al. developed cubical persistent-homology losses for 3D medical tasks. In parallel, GPU-accelerated persistence computation and differentiable topological summaries have significantly improved practical feasibility.

In China, retinal vessel segmentation research has made substantial progress in feature fusion, attention modules, and lightweight deployment. Nevertheless, evaluation protocols still center on pixel metrics (AUC, F1, Dice), and topology-aware indicators are less frequently incorporated into mainstream benchmarking. As a result, structural defects such as centerline breaks or incorrect connected components may remain under-penalized. This project addresses that gap by integrating topological priors during training rather than relying only on post-processing repair.

The significance of this work is threefold. First, from a methodological perspective, it contributes to the integration of geometric/topological priors with data-driven CNN optimization, enriching the theory of structure-preserving learning in medical imaging. Second, from an engineering perspective, a reusable PH regularization module can be adapted to existing PyTorch pipelines with limited architectural changes, improving reproducibility and deployment potential on moderate hardware (e.g., 6GB GPU devices). Third, from an application perspective, better continuity and fewer false topological artifacts can improve the reliability of quantitative retinal biomarkers, which is essential for robust AI-assisted screening systems. Overall, the project is expected to provide a practical paradigm for “deep learning + topology” in fine-structure medical segmentation.

---

## （2）研究的基本内容、目标、拟采用的技术方案及措施

### 基本内容
本研究围绕“拓扑约束下的视网膜血管分割”展开，主要包括四个模块：
1. **数据与预处理模块**：整合DRIVE与CHASE_DB1等公开眼底数据，统一尺寸、颜色空间和标签格式；采用随机旋转、翻转、亮度/对比度扰动、随机裁剪等增强策略，提高对成像差异的鲁棒性。
2. **基线模型与拓扑模块构建**：以U-Net为基线，首先复现稳定训练流程；再将输出概率图转化为cubical复形，通过持续同调提取连通分量持久特征，构造可导拓扑损失并与Dice/Focal联合。
3. **联合训练与对比实验**：设计“无拓扑约束基线”“固定权重拓扑损失”“动态权重拓扑损失”三组实验，并进行消融分析（不同\(\lambda\)、不同阈值策略、是否使用后处理）。
4. **评价与可解释分析**：除Dice、IoU、AUC、Sensitivity、Specificity外，重点引入CL-Break（中心线碎片数）与\(\Delta\beta_0\)（Betti误差）评估结构连续性；结合持久图高激活区间反投影，分析拓扑损失修复断裂的机制。

### 研究目标
1. 在DRIVE测试集上实现**Dice ≥ 0.835**，在联合数据设置下相较基线Dice提升不少于1.5个百分点。
2. 在结构指标上实现**CL-Break降低≥30%**、\(\Delta\beta_0\)显著下降，证明拓扑一致性改善。
3. 将拓扑模块设计为可插拔组件，保持训练脚本与推理流程兼容，单张256×256图像额外时延控制在15ms以内（增量开销）。
4. 完成可复现实验文档与代码整理，支持在6GB显存环境复现主要结果。

### 拟采用的技术方案
1. **模型结构**：采用U-Net主干（编码器-解码器+跳跃连接），输出血管概率图。
2. **损失函数**：
   \[
   L_{total}=L_{Dice}+\alpha L_{Focal}+\lambda L_{topo}
   \]
   其中\(\lambda\)采用分段升温：前30个epoch固定0.1，后续线性增至0.5，以降低早期噪声拓扑梯度干扰。
3. **持续同调计算**：基于二维cubical complex对概率图进行0维PH计算，使用可导近似（如Persistence Landscape）回传梯度；结合GPU并行策略提升效率。
4. **训练与验证策略**：采用分层学习率、早停与交叉验证；通过网格搜索/贝叶斯调参确定\(\alpha,\lambda\)、学习率、阈值等关键参数。
5. **评估体系**：像素指标 + 拓扑指标 + 运行效率三维评估，确保“精度、结构、速度”平衡。

### 实施措施
- **分模块开发**：先完成基线复现，再独立开发拓扑损失模块，最后进行接口整合，降低调试耦合度。
- **阶段性验收**：每两周固定输出实验日志、可视化结果与指标表，确保问题可定位、进度可追踪。
- **风险预案**：若拓扑项导致训练不稳定，将采用梯度裁剪、权重上限约束、延后启用或仅对高置信区域施加拓扑约束。
- **可复现管理**：固定随机种子、记录配置文件、冻结依赖版本并维护实验脚本，确保结果可复查。

---

## （3）进度安排（按周）

- **第1–2周**：收集并精读相关文献（重点为U-Net变体、拓扑损失、眼底血管分割评估指标）；完成开题报告初稿与研究问题细化。  
- **第3–4周**：整理DRIVE与CHASE_DB1数据，完成预处理与增强流水线；构建统一数据加载接口与可视化质检脚本。  
- **第5–6周**：复现并验证U-Net基线训练流程；在单数据集和联合数据集上获得可对比基线结果。  
- **第7–8周**：实现持续同调特征提取与拓扑损失原型（CPU/GPU版本对照）；完成小样本可微性与数值稳定性测试。  
- **第9–10周**：完成拓扑模块与主干网络集成；设计\(\lambda\)升温策略并开展第一轮联合训练。  
- **第11–12周**：进行核心消融实验（损失权重、阈值策略、后处理开关、不同增强组合）；汇总像素与拓扑双指标。  
- **第13–14周**：开展跨数据集泛化实验与鲁棒性分析；评估推理延时和显存占用，优化实现效率。  
- **第15–16周**：完成可解释性分析（持续图激活区间反投影、失败样例归因）；形成阶段性报告。  
- **第17–18周**：整理论文方法、实验与结果章节，补充图表与统计检验；完成英文文献翻译任务。  
- **第19–20周**：提交论文初稿，依据导师反馈进行修改；补充实验与文字润色。  
- **第21–22周**：完成定稿、查重与答辩PPT准备；进行答辩演练与材料归档。

---

## （4）参考文献（GB/T 7714）

[1] RONNEBERGER O, FISCHER P, BROX T. U-Net: Convolutional Networks for Biomedical Image Segmentation[C]//MICCAI 2015. Cham: Springer, 2015: 234-241.  
[2] OKTAY O, SCHLEMPER J, LE FOLGOC L, et al. Attention U-Net: Learning Where to Look for the Pancreas[EB/OL]. arXiv:1804.03999, 2018.  
[3] ZHOU Z, SIDDIQUEE M M R, TAJBAKHSH N, et al. UNet++: A Nested U-Net Architecture for Medical Image Segmentation[C]//DLMIA 2018. Cham: Springer, 2018: 3-11.  
[4] HUANG H, LIN L, TONG R, et al. UNet 3+: A Full-Scale Connected UNet for Medical Image Segmentation[C]//ICASSP 2020. Barcelona: IEEE, 2020: 1055-1059.  
[5] HU X, FUXIN L, SAMARAS D, et al. Topology-Preserving Deep Image Segmentation[EB/OL]. arXiv:1906.05475, 2019.  
[6] CLOUGH J R, OKSUZ I, BYRNE N, et al. A Topological Loss Function for Deep-Learning Based Image Segmentation Using Persistent Homology[J]. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2022, 44(12): 8766-8778.  
[7] GAO Y, ZHANG Y, LIU M, et al. Cubical Persistent Homology Loss for 3D Medical Image Segmentation[C]//CVPR 2023. Vancouver: IEEE/CVF, 2023: 16590-16599.  
[8] MOOR M, HORN M, RIETSCH C, et al. Topological Autoencoders[C]//ICML 2020. Vienna: PMLR, 2020: 7045-7054.  
[9] EDELSBRUNNER H, HARER J. Persistent Homology—A Survey[M]//Surveys on Discrete and Computational Geometry. Providence: American Mathematical Society, 2008: 257-282.  
[10] CHAZAL F, MICHEL B. An Introduction to Topological Data Analysis: Fundamental and Practical Aspects for Data Scientists[J]. Frontiers in Artificial Intelligence, 2021, 4: 667963.  
[11] STAAL J, ABRAMOFF M D, NIEMEIJER M, et al. Ridge-Based Vessel Segmentation in Color Images of the Retina[J]. IEEE Transactions on Medical Imaging, 2004, 23(4): 501-509.  
[12] HOOVER A, KOUBA P, GOLDBAUM M. Locating Blood Vessels in Retinal Images by Piecewise Threshold Probing of a Matched Filter Response[J]. IEEE Transactions on Medical Imaging, 2000, 19(3): 203-210.  
[13] FRAZ M M, REMAGNINO P, HOPPE A, et al. Blood Vessel Segmentation Methodologies in Retinal Images—A Survey[J]. Computer Methods and Programs in Biomedicine, 2012, 108(1): 407-433.  
[14] LISKOWSKI P, KRAWCZYK K. Segmenting Retinal Blood Vessels with Deep Neural Networks[J]. IEEE Transactions on Medical Imaging, 2016, 35(11): 2369-2380.  
[15] FU H, XU Y, LIN S, et al. DeepVessel: Retinal Vessel Segmentation via Deep Learning and Conditional Random Field[C]//MICCAI 2016. Cham: Springer, 2016: 132-139.  
[16] JIN Q, MENG Z, PHAM T D, et al. DUNet: A Deformable Network for Retinal Vessel Segmentation[J]. Knowledge-Based Systems, 2019, 178: 149-162.  
[17] LI L, VERMA M, NAKASHIMA Y, et al. Iternet: Retinal Image Segmentation Utilizing Structural Redundancy in Vessel Networks[C]//WACV 2020. Snowmass Village: IEEE/CVF, 2020: 3656-3665.  
[18] NIEMEIJER M, STAAL J, VAN GINNEKEN B, et al. Comparative Study of Retinal Vessel Segmentation Methods on a New Publicly Available Database[J]. Medical Image Analysis, 2004, 8(2): 177-190.
